import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split, learning_curve
from sklearn.metrics import classification_report, confusion_matrix, ConfusionMatrixDisplay
from nltk.corpus import stopwords
from nltk.stem import SnowballStemmer
import string
import re
import nltk
import joblib
import seaborn as sns

# Настройка стиля графиков
plt.style.use('default')
sns.set_palette('husl')

# Скачивание стоп-слов (при первом запуске)
try:
    nltk.data.find('corpora/stopwords')
except LookupError:
    nltk.download('stopwords')

# Инициализация
russian_stopwords = stopwords.words("russian")
stemmer = SnowballStemmer("russian")

def preprocess_text(text):
    """Предварительная обработка текста"""
    if not isinstance(text, str):
        return ""

    text = text.lower()
    text = re.sub('[%s]' % re.escape(string.punctuation), '', text)
    text = re.sub(r'\d+', '', text)
    text = re.sub(r'\s+', ' ', text).strip()

    tokens = []
    for token in text.split():
        if token not in russian_stopwords:
            token = stemmer.stem(token)
            tokens.append(token)

    return " ".join(tokens)

# Загрузка данных из файла

..
